<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Morning Ritual - Votre Routine Quotidienne</title>
    
    <!-- PWA Configuration -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#5B8FA3">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Morning Ritual">
    
    <!-- iOS Icons -->
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 192'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23FFB89D;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%237FB3D5;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='192' height='192' rx='42' fill='url(%23grad)'/%3E%3Ctext x='96' y='130' font-size='80' text-anchor='middle' fill='white'%3E‚òÄÔ∏è%3C/text%3E%3C/svg%3E">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='80' font-size='80'%3E‚òÄÔ∏è%3C/text%3E%3C/svg%3E">
    
    <!-- Meta Description -->
    <meta name="description" content="Morning Ritual - Votre routine quotidienne personnalis√©e pour une vie plus saine. 10 minutes par jour pour transformer votre bien-√™tre.">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600&family=Inter:wght@300;400;500;600&display=swap');
        
        :root {
            --dawn-pink: #FF6B9D;
            --sunrise-orange: #FF8E53;
            --morning-blue: #4A90E2;
            --sky-blue: #5DADE2;
            --deep-blue: #3498DB;
            --text-dark: #E8E8E8;
            --text-light: #A0A0A0;
            --white: #1E1E1E;
            --card-bg: #2A2A2A;
            --background: #121212;
            --shadow-soft: rgba(0, 0, 0, 0.3);
            --shadow-medium: rgba(0, 0, 0, 0.5);
            --accent-glow: rgba(255, 142, 83, 0.15);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #0f0f23 100%);
            color: var(--text-dark);
            overflow-x: hidden;
            min-height: 100vh;
            padding-bottom: 90px;
        }
        
        /* iPhone Style Container */
        .phone-container {
            max-width: 430px;
            margin: 0 auto;
            background: var(--background);
            min-height: 100vh;
            box-shadow: 0 0 50px var(--shadow-medium);
        }
        
        /* Status Bar */
        .status-bar {
            height: 44px;
            background: transparent;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            font-size: 15px;
            font-weight: 500;
            color: var(--text-dark);
        }
        
        .time {
            font-weight: 600;
        }
        
        .status-icons {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        /* Header */
        .header {
            padding: 20px 24px;
            background: linear-gradient(180deg, rgba(42, 42, 42, 0.8) 0%, transparent 100%);
        }
        
        .greeting {
            font-family: 'Cormorant Garamond', serif;
            font-size: 36px;
            font-weight: 300;
            color: var(--text-dark);
            margin-bottom: 4px;
            letter-spacing: -0.5px;
            text-align: center;
        }
        
        .date-info {
            font-size: 14px;
            color: var(--text-light);
            font-weight: 400;
            text-align: center;
        }
        
        /* Main Content */
        .content {
            padding: 0 24px 24px;
        }
        
        /* Daily Card */
        .daily-card {
            background: var(--card-bg);
            border-radius: 24px;
            padding: 28px;
            margin-bottom: 20px;
            box-shadow: 0 8px 30px var(--shadow-soft), 0 0 40px var(--accent-glow);
            position: relative;
            overflow: hidden;
            animation: slideUp 0.6s ease-out;
            border: 1px solid rgba(255, 142, 83, 0.1);
        }
        
        .daily-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--sunrise-orange), var(--sky-blue));
        }
        
        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            background: linear-gradient(135deg, var(--sunrise-orange), var(--morning-blue));
        }
        
        .card-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 24px;
            font-weight: 500;
            color: var(--text-dark);
            text-align: center;
        }
        
        .card-subtitle {
            font-size: 13px;
            color: var(--text-light);
            margin-top: 2px;
        }
        
        /* Weather & Context */
        .context-row {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
        }
        
        .context-chip {
            flex: 1;
            background: rgba(255, 142, 83, 0.08);
            padding: 12px 16px;
            border-radius: 12px;
            font-size: 13px;
            text-align: center;
            border: 1px solid rgba(255, 142, 83, 0.15);
        }
        
        .context-value {
            font-weight: 600;
            color: var(--sunrise-orange);
            display: block;
            margin-top: 4px;
        }
        
        /* Activity Section */
        .activity-section {
            margin-bottom: 20px;
        }
        
        .activity-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            cursor: pointer;
            user-select: none;
            padding: 4px;
            border-radius: 8px;
            transition: background 0.2s ease;
        }
        
        .activity-header:hover {
            background: rgba(255, 142, 83, 0.05);
        }
        
        .activity-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid rgba(255, 142, 83, 0.4);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-shrink: 0;
            margin-left: auto;
            order: 3;
        }
        
        .activity-checkbox.checked {
            background: linear-gradient(135deg, var(--sunrise-orange), var(--deep-blue));
            border-color: var(--sunrise-orange);
        }
        
        .activity-checkbox .checkmark {
            display: none;
            color: white;
            font-size: 14px;
            font-weight: bold;
        }
        
        .activity-checkbox.checked .checkmark {
            display: block;
        }
        
        .activity-icon {
            font-size: 20px;
        }
        
        .activity-title {
            font-weight: 600;
            font-size: 15px;
            color: var(--text-dark);
            order: 2;
        }
        
        .activity-duration {
            font-size: 13px;
            color: var(--text-light);
            background: rgba(255, 142, 83, 0.1);
            padding: 4px 12px;
            border-radius: 12px;
            margin-right: auto;
            order: 4;
        }
        
        .expand-icon {
            font-size: 16px;
            color: var(--text-light);
            transition: transform 0.3s ease;
            flex-shrink: 0;
            order: 5;
        }
        
        .activity-section.expanded .expand-icon {
            transform: rotate(180deg);
        }
        
        .activity-content {
            background: rgba(255, 142, 83, 0.05);
            padding: 16px;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-dark);
            border: 1px solid rgba(255, 142, 83, 0.1);
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .activity-section.expanded .activity-content {
            max-height: 500px;
            opacity: 1;
            margin-top: 12px;
        }
        
        /* Recommendation */
        .recommendation-section {
            margin-bottom: 20px;
        }
        
        .recommendation-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            cursor: pointer;
            user-select: none;
            padding: 4px;
            border-radius: 8px;
            transition: background 0.2s ease;
        }
        
        .recommendation-header:hover {
            background: rgba(255, 142, 83, 0.05);
        }
        
        .recommendation-header .activity-title {
            order: 2;
        }
        
        .recommendation-header .expand-icon {
            margin-left: auto;
            order: 3;
        }
        
        .recommendation {
            background: linear-gradient(135deg, rgba(255, 107, 157, 0.15), rgba(77, 144, 226, 0.15));
            padding: 16px;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-dark);
            font-weight: 400;
            border: 1px solid rgba(255, 142, 83, 0.2);
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .recommendation-section.expanded .recommendation {
            max-height: 500px;
            opacity: 1;
            margin-top: 12px;
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }
        
        .btn {
            flex: 1;
            padding: 16px;
            border-radius: 16px;
            border: none;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--sunrise-orange), var(--deep-blue));
            color: white;
            box-shadow: 0 4px 15px rgba(255, 142, 83, 0.3);
        }
        
        .btn-primary:hover {
            box-shadow: 0 6px 20px rgba(255, 142, 83, 0.4);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: rgba(255, 142, 83, 0.1);
            color: var(--text-dark);
            border: 1px solid rgba(255, 142, 83, 0.2);
        }
        
        .btn:active {
            transform: scale(0.96);
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 12px var(--shadow-soft);
            border: 1px solid rgba(255, 142, 83, 0.1);
            text-align: center;
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--text-light);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }
        
        .stat-value {
            font-family: 'Cormorant Garamond', serif;
            font-size: 32px;
            font-weight: 600;
            color: var(--sunrise-orange);
        }
        
        .stat-change {
            font-size: 12px;
            color: var(--text-light);
            margin-top: 4px;
        }
        
        .positive {
            color: #10B981;
        }
        
        /* Progress Ring */
        .progress-ring {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 24px 0;
            position: relative;
        }
        
        .ring-svg {
            transform: rotate(-90deg);
        }
        
        .ring-bg {
            fill: none;
            stroke: rgba(255, 142, 83, 0.1);
            stroke-width: 8;
        }
        
        .ring-progress {
            fill: none;
            stroke: url(#gradient);
            stroke-width: 8;
            stroke-linecap: round;
            transition: stroke-dashoffset 1s ease;
        }
        
        .ring-center {
            position: absolute;
            text-align: center;
        }
        
        .ring-value {
            font-family: 'Cormorant Garamond', serif;
            font-size: 42px;
            font-weight: 600;
            color: var(--sunrise-orange);
        }
        
        .ring-label {
            font-size: 13px;
            color: var(--text-light);
            margin-top: -4px;
        }
        
        /* Chart */
        .chart-container {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 12px var(--shadow-soft);
            margin-bottom: 20px;
            border: 1px solid rgba(255, 142, 83, 0.1);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .chart-title {
            font-weight: 600;
            font-size: 16px;
            text-align: center;
            flex: 1;
        }
        
        .chart-period {
            display: flex;
            gap: 8px;
        }
        
        .period-btn {
            padding: 6px 12px;
            border-radius: 8px;
            border: none;
            background: transparent;
            color: var(--text-light);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .period-btn.active {
            background: linear-gradient(135deg, var(--sunrise-orange), var(--deep-blue));
            color: var(--white);
        }
        
        .chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 150px;
            gap: 8px;
            padding: 0 4px;
        }
        
        .bar-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .bar {
            width: 100%;
            background: linear-gradient(180deg, var(--sunrise-orange), var(--sky-blue));
            border-radius: 6px 6px 0 0;
            transition: all 0.6s ease;
            animation: growBar 1s ease-out;
        }
        
        .bar-label {
            font-size: 11px;
            color: var(--text-light);
        }
        
        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            max-width: 430px;
            margin: 0 auto;
            background: var(--card-bg);
            padding: 12px 24px 28px;
            display: flex;
            justify-content: space-around;
            box-shadow: 0 -4px 20px var(--shadow-soft);
            border-radius: 24px 24px 0 0;
            border-top: 1px solid rgba(255, 142, 83, 0.1);
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 16px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-light);
            text-decoration: none;
        }
        
        .nav-item.active {
            background: rgba(255, 142, 83, 0.15);
            color: var(--sunrise-orange);
        }
        
        .nav-icon {
            font-size: 24px;
        }
        
        .nav-label {
            font-size: 11px;
            font-weight: 500;
        }
        
        /* Animations */
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes growBar {
            from {
                height: 0;
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        /* Notification Style */
        .notification {
            position: fixed;
            top: 60px;
            left: 24px;
            right: 24px;
            max-width: 382px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 40px var(--shadow-medium);
            z-index: 1000;
            animation: slideDown 0.4s ease-out;
            display: none;
            border: 1px solid rgba(255, 142, 83, 0.2);
        }
        
        .notification.show {
            display: block;
        }
        
        @keyframes slideDown {
            from {
                transform: translateY(-100px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .notification-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .app-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--sunrise-orange), var(--sky-blue));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .notification-title {
            font-weight: 600;
            font-size: 15px;
        }
        
        .notification-time {
            margin-left: auto;
            font-size: 13px;
            color: var(--text-light);
        }
        
        .notification-body {
            font-size: 14px;
            line-height: 1.5;
            color: var(--text-dark);
        }
        
        /* Hidden screens */
        .screen {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .screen.active {
            display: block;
        }
        
        /* Comparison View */
        .comparison-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 12px var(--shadow-soft);
            margin-bottom: 16px;
            border: 1px solid rgba(255, 142, 83, 0.1);
        }
        
        .comparison-header {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .year-label {
            font-weight: 600;
            font-size: 18px;
            color: var(--sunrise-orange);
        }
        
        .comparison-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }
        
        .comparison-stat {
            text-align: center;
        }
        
        .comparison-value {
            font-family: 'Cormorant Garamond', serif;
            font-size: 28px;
            font-weight: 600;
            color: var(--text-dark);
        }
        
        .comparison-label {
            font-size: 11px;
            color: var(--text-light);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 4px;
        }
        /* Badge System */
        .badges-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .badge-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 16px;
            text-align: center;
            box-shadow: 0 4px 12px var(--shadow-soft);
            border: 1px solid rgba(255, 142, 83, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .badge-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px var(--shadow-medium);
        }

        .badge-card.locked {
            opacity: 0.4;
        }

        .badge-icon {
            font-size: 36px;
            margin-bottom: 8px;
            filter: grayscale(100%);
            transition: filter 0.3s ease;
        }

        .badge-card:not(.locked) .badge-icon {
            filter: grayscale(0%);
        }

        .badge-name {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 4px;
        }

        .badge-desc {
            font-size: 10px;
            color: var(--text-light);
        }

        /* Level Progress */
        .level-card {
            background: linear-gradient(135deg, var(--sunrise-orange), var(--deep-blue));
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            color: white;
            text-align: center;
        }

        .level-number {
            font-family: 'Cormorant Garamond', serif;
            font-size: 48px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .level-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .xp-bar {
            background: rgba(255, 255, 255, 0.2);
            height: 12px;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .xp-fill {
            background: white;
            height: 100%;
            border-radius: 6px;
            transition: width 0.5s ease;
        }

        .xp-text {
            font-size: 13px;
            opacity: 0.9;
        }

        /* History List */
        .history-list {
            margin-top: 20px;
        }

        .history-item {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 16px;
            box-shadow: 0 4px 12px var(--shadow-soft);
            border: 1px solid rgba(255, 142, 83, 0.1);
            transition: all 0.3s ease;
        }

        .history-date {
            text-align: center;
            min-width: 60px;
        }

        .history-day {
            font-family: 'Cormorant Garamond', serif;
            font-size: 28px;
            font-weight: 600;
            color: var(--sunrise-orange);
        }

        .history-month {
            font-size: 11px;
            color: var(--text-light);
            text-transform: uppercase;
        }

        .history-details {
            flex: 1;
        }

        .history-status {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 4px;
        }

        .history-activities {
            font-size: 12px;
            color: var(--text-light);
        }

        .history-icon {
            font-size: 24px;
        }

        /* Settings */
        .settings-section {
            margin-bottom: 24px;
        }

        .settings-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-light);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .settings-item {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid rgba(255, 142, 83, 0.1);
        }

        .settings-item:hover {
            background: rgba(255, 142, 83, 0.05);
        }

        .settings-label {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 15px;
            color: var(--text-dark);
        }

        .settings-value {
            font-size: 14px;
            color: var(--text-light);
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 28px;
            background: rgba(255, 142, 83, 0.2);
            border-radius: 14px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .toggle-switch.active {
            background: linear-gradient(135deg, var(--sunrise-orange), var(--deep-blue));
        }

        .toggle-knob {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        .toggle-switch.active .toggle-knob {
            transform: translateX(22px);
        }

        /* Profile Card */
        .profile-card {
            background: linear-gradient(135deg, var(--sunrise-orange), var(--deep-blue));
            border-radius: 20px;
            padding: 32px;
            text-align: center;
            color: white;
            margin-bottom: 24px;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            margin: 0 auto 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
        }

        .profile-name {
            font-family: 'Cormorant Garamond', serif;
            font-size: 32px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .profile-email {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 16px;
        }

        .profile-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }

        .profile-stat {
            text-align: center;
        }

        .profile-stat-value {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .profile-stat-label {
            font-size: 12px;
            opacity: 0.8;
        }

        /* Light Theme Colors (add to your :root[data-theme="light"]) */
        :root[data-theme="light"] .level-card,
        :root[data-theme="light"] .profile-card {
            color: white; /* Keep text white on gradient backgrounds */
        }

        :root[data-theme="light"] .badge-card,
        :root[data-theme="light"] .history-item,
        :root[data-theme="light"] .settings-item {
            background: #FFFFFF;
            border: 1px solid rgba(91, 143, 163, 0.15);
        }

        :root[data-theme="light"] .toggle-switch {
            background: rgba(91, 143, 163, 0.2);
        }

        :root[data-theme="light"] .xp-bar {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Insights */
        .insight-item {
            display: flex;
            align-items: start;
            gap: 12px;
            padding: 12px;
            background: rgba(255, 142, 83, 0.05);
            border-radius: 12px;
            margin-bottom: 12px;
        }

        .insight-icon {
            font-size: 20px;
            flex-shrink: 0;
        }

        .insight-text {
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-dark);
        }

        /* Journal Character Count */
        .char-count {
            text-align: right;
            font-size: 12px;
            color: var(--text-light);
            margin-top: 8px;
        }

        /* Additional Dashboard Stats */
        .stats-grid-extended {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="phone-container">
        <!-- Status Bar -->
        <div class="status-bar">
            <span class="time" id="currentTime">9:41</span>
            <div class="status-icons">
                <span>üì∂</span>
                <span>üì°</span>
                <span>üîã</span>
            </div>
        </div>
        
        <!-- Notification (Hidden by default) -->
        <div class="notification" id="notification">
            <div class="notification-header">
                <div class="app-icon">‚òÄÔ∏è</div>
                <div>
                    <div class="notification-title">Morning Ritual</div>
                </div>
                <span class="notification-time">maintenant</span>
            </div>
            <div class="notification-body">
                Votre routine matinale est pr√™te ! Une journ√©e ensoleill√©e vous attend üå§Ô∏è
            </div>
        </div>
        
        <!-- Home Screen -->
        <div class="screen active" id="homeScreen">
            <!-- Header -->
            <div class="header">
                <h1 class="greeting" id="greeting">Bonjour</h1>
                <p class="date-info" id="dateInfo">Mardi 6 Janvier 2026</p>
            </div>
            
            <!-- Main Content -->
            <div class="content">
                <!-- Daily Recommendation Card -->
                <div class="daily-card">
                    <div class="card-header">
                        <div class="icon">‚òÄÔ∏è</div>
                        <div>
                            <h2 class="card-title">Votre Rituel du Jour</h2>
                            <p class="card-subtitle">Personnalis√© pour vous</p>
                        </div>
                    </div>
                    
                    <!-- Context -->
                    <div class="context-row">
                        <div class="context-chip">
                            <div>M√©t√©o</div>
                            <span class="context-value">18¬∞C ‚òÅÔ∏è</span>
                        </div>
                        <div class="context-chip">
                            <div>√âv√©nements</div>
                            <span class="context-value">3 r√©unions</span>
                        </div>
                        <div class="context-chip">
                            <div>Sommeil</div>
                            <span class="context-value">7h 30m</span>
                        </div>
                    </div>
                    
                    <!-- Sport Activity -->
                    <div class="activity-section" id="sportSection">
                        <div class="activity-header" onclick="toggleActivity('sport')">
                            <span class="activity-icon">üèÉ</span>
                            <span class="activity-title">Exercice</span>
                            <span class="activity-duration">5 min</span>
                            <div class="activity-checkbox" id="sportCheckbox" onclick="event.stopPropagation(); toggleCheckbox('sport')">
                                <span class="checkmark">‚úì</span>
                            </div>
                            <span class="expand-icon">‚ñº</span>
                        </div>
                        <div class="activity-content">
                            <strong>√âchauffement dynamique</strong><br>
                            Parfait pour une journ√©e charg√©e : 10 jumping jacks, 10 squats, 20 mountain climbers, 10 pompes. Le temps est frais, id√©al pour activer votre circulation.
                        </div>
                    </div>
                    
                    <!-- Meditation Activity -->
                    <div class="activity-section" id="meditationSection">
                        <div class="activity-header" onclick="toggleActivity('meditation')">
                            <span class="activity-icon">üßò</span>
                            <span class="activity-title">M√©ditation</span>
                            <span class="activity-duration">5 min</span>
                            <div class="activity-checkbox" id="meditationCheckbox" onclick="event.stopPropagation(); toggleCheckbox('meditation')">
                                <span class="checkmark">‚úì</span>
                            </div>
                            <span class="expand-icon">‚ñº</span>
                        </div>
                        <div class="activity-content">
                            <strong>Respiration consciente</strong><br>
                            Asseyez-vous confortablement. Inspirez profond√©ment pendant 4 secondes, retenez 4 secondes, expirez 6 secondes. R√©p√©tez en vous concentrant sur votre respiration et les sensations de votre corps.
                        </div>
                    </div>
                    
                    <!-- Daily Recommendation -->
                    <div class="recommendation-section" id="recommendationSection">
                        <div class="recommendation-header" onclick="toggleActivity('recommendation')">
                            <span class="activity-icon">üí°</span>
                            <span class="activity-title">Recommandation</span>
                            <span class="expand-icon">‚ñº</span>
                        </div>
                        <div class="recommendation">
                            Avec vos 3 r√©unions aujourd'hui et le temps nuageux, pr√©voyez des pauses courtes entre chaque rendez-vous. Hydratez-vous r√©guli√®rement. Profitez de votre d√©jeuner pour une marche de 15 minutes - cela compensera la journ√©e s√©dentaire.
                        </div>
                    </div>

                    <!-- Journal Section -->
                    <div class="journal-section">
                        <div class="activity-header" style="margin-bottom: 12px; cursor: default;">
                            <span class="activity-icon">üìù</span>
                            <span class="activity-title">Journal du Jour</span>
                        </div>
                        <textarea 
                            class="journal-textarea" 
                            id="journalText"
                            placeholder="Comment vous sentez-vous aujourd'hui ? Quelles sont vos intentions pour cette journ√©e ? (optionnel)"
                            maxlength="500"></textarea>
                        <div class="char-count" id="charCount">0 / 500</div>
                    </div>
                                        
                    <!-- Action Buttons -->
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="completeRoutine()">‚úì Routine termin√©e</button>
                    </div>
                </div>
                
                <!-- Quick Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">S√©rie Actuelle</div>
                        <div class="stat-value">12</div>
                        <div class="stat-change positive">‚Üë Record personnel !</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Ce Mois</div>
                        <div class="stat-value">6/6</div>
                        <div class="stat-change">100% de taux de compl√©tion</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Dashboard Screen -->
        <div class="screen" id="dashboardScreen">
            <div class="header">
                <h1 class="greeting">Tableau de Bord</h1>
                <p class="date-info">Vos progr√®s et statistiques</p>
            </div>
            
            <div class="content">
                <!-- Level Card -->
                <div class="level-card">
                    <div class="level-number" id="levelNumber">5</div>
                    <div class="level-name" id="levelName">Pratiquant D√©vou√©</div>
                    <div class="xp-bar">
                        <div class="xp-fill" id="xpFill" style="width: 60%;"></div>
                    </div>
                    <div class="xp-text" id="xpText">60 / 100 XP jusqu'au niveau 6</div>
                </div>
                <!-- Progress Ring with Period Selector -->
                <div class="daily-card">
                    <div class="chart-period" style="justify-content: center; margin-bottom: 20px;">
                        <button class="period-btn active" onclick="changePeriod('week')">Sem</button>
                        <button class="period-btn" onclick="changePeriod('month')">Mois</button>
                        <button class="period-btn" onclick="changePeriod('year')">Ann√©e</button>
                    </div>
                    <h3 class="card-title" style="margin-bottom: 16px;">Taux de Compl√©tion</h3>
                    <div class="progress-ring">
                        <svg class="ring-svg" width="200" height="200">
                            <defs>
                                <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#FFB89D;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#7FB3D5;stop-opacity:1" />
                                </linearGradient>
                            </defs>
                            <circle class="ring-bg" cx="100" cy="100" r="80" />
                            <circle class="ring-progress" cx="100" cy="100" r="80" 
                                    stroke-dasharray="502.4" 
                                    stroke-dashoffset="70.3"
                                    id="progressCircle" />
                        </svg>
                        <div class="ring-center">
                            <div class="ring-value" id="completionRate">86%</div>
                            <div class="ring-label" id="completionPeriod">Cette semaine</div>
                        </div>
                    </div>
                </div>
                
                <!-- Activity Chart -->
                <div class="chart-container">
                    <h3 class="chart-title" style="margin-bottom: 20px;">Activit√©</h3>
                    <div class="chart" id="activityChart">
                        <div class="bar-container">
                            <div class="bar" style="height: 80%;"></div>
                            <span class="bar-label">Lun</span>
                        </div>
                        <div class="bar-container">
                            <div class="bar" style="height: 100%;"></div>
                            <span class="bar-label">Mar</span>
                        </div>
                        <div class="bar-container">
                            <div class="bar" style="height: 70%;"></div>
                            <span class="bar-label">Mer</span>
                        </div>
                        <div class="bar-container">
                            <div class="bar" style="height: 90%;"></div>
                            <span class="bar-label">Jeu</span>
                        </div>
                        <div class="bar-container">
                            <div class="bar" style="height: 60%;"></div>
                            <span class="bar-label">Ven</span>
                        </div>
                        <div class="bar-container">
                            <div class="bar" style="height: 85%;"></div>
                            <span class="bar-label">Sam</span>
                        </div>
                        <div class="bar-container">
                            <div class="bar" style="height: 95%;"></div>
                            <span class="bar-label">Dim</span>
                        </div>
                    </div>
                </div>
                
                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total 2026</div>
                        <div class="stat-value">6</div>
                        <div class="stat-change">jours compl√©t√©s</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Plus longue s√©rie</div>
                        <div class="stat-value">12</div>
                        <div class="stat-change">jours cons√©cutifs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label" id="sportLabel">Sport</div>
                        <div class="stat-value" id="sportValue">30</div>
                        <div class="stat-change positive" id="sportPeriod">min cette semaine</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label" id="meditationLabel">M√©ditation</div>
                        <div class="stat-value" id="meditationValue">30</div>
                        <div class="stat-change positive" id="meditationPeriod">min cette semaine</div>
                    </div>
                </div>

                <!-- Additional Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Taux moyen</div>
                        <div class="stat-value">91%</div>
                        <div class="stat-change positive">‚Üë +5% vs mois dernier</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Meilleur jour</div>
                        <div class="stat-value" style="font-size: 20px;">Mardi</div>
                        <div class="stat-change">100% de r√©ussite</div>
                    </div>
                </div>

                <!-- Badges Section -->
                <div class="daily-card">
                    <h3 class="card-title" style="margin-bottom: 20px;">Badges & Achievements</h3>
                    <div class="badges-container">
                        <!-- Rempli dynamiquement par JavaScript -->
                    </div>
                </div>


            </div>
        </div>
        
        <!-- Comparison Screen -->
        <div class="screen" id="comparisonScreen">
            <div class="header">
                <h1 class="greeting">Comparaison Annuelle</h1>
                <p class="date-info">Suivez votre √©volution</p>
            </div>
            
            <div class="content">
                <!-- 2026 Stats -->
                <div class="comparison-card">
                    <div class="comparison-header">
                        <span class="year-label">2026 (en cours)</span>
                        <span style="font-size: 24px;">üéØ</span>
                    </div>
                    <div class="comparison-stats">
                        <div class="comparison-stat">
                            <div class="comparison-value">6</div>
                            <div class="comparison-label">Jours</div>
                        </div>
                        <div class="comparison-stat">
                            <div class="comparison-value">100%</div>
                            <div class="comparison-label">Taux</div>
                        </div>
                        <div class="comparison-stat">
                            <div class="comparison-value">12</div>
                            <div class="comparison-label">S√©rie</div>
                        </div>
                    </div>
                </div>
                
                <!-- 2025 Stats -->
                <div class="comparison-card">
                    <div class="comparison-header">
                        <span class="year-label">2025</span>
                        <span style="font-size: 24px;">‚úÖ</span>
                    </div>
                    <div class="comparison-stats">
                        <div class="comparison-stat">
                            <div class="comparison-value">274</div>
                            <div class="comparison-label">Jours</div>
                        </div>
                        <div class="comparison-stat">
                            <div class="comparison-value">75%</div>
                            <div class="comparison-label">Taux</div>
                        </div>
                        <div class="comparison-stat">
                            <div class="comparison-value">45</div>
                            <div class="comparison-label">S√©rie max</div>
                        </div>
                    </div>
                </div>
                
                <!-- Insights -->
                <div class="daily-card">
                    <div class="card-header">
                        <div class="icon">üìä</div>
                        <div>
                            <h2 class="card-title">Insights & Analyses</h2>
                            <p class="card-subtitle">Vos progr√®s d√©taill√©s</p>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <div class="insight-item">
                            <span class="insight-icon">üéâ</span>
                            <div class="insight-text">
                                <strong>Excellente progression !</strong> Vous avez d√©j√† d√©pass√© votre d√©but 2025 (4 jours √† cette p√©riode). Continuez sur cette lanc√©e !
                            </div>
                        </div>
                        
                        <div class="insight-item">
                            <span class="insight-icon">üî•</span>
                            <div class="insight-text">
                                <strong>S√©rie impressionnante :</strong> Votre s√©rie actuelle de 12 jours est prometteuse. Plus que 33 jours pour battre votre record de 45 jours !
                            </div>
                        </div>
                        
                        <div class="insight-item">
                            <span class="insight-icon">üìà</span>
                            <div class="insight-text">
                                <strong>Am√©lioration constante :</strong> Votre taux de compl√©tion moyen est de 91%, soit +16% par rapport √† votre moyenne 2025 (75%).
                            </div>
                        </div>
                        
                        <div class="insight-item">
                            <span class="insight-icon">üí™</span>
                            <div class="insight-text">
                                <strong>Consistance :</strong> Vous r√©ussissez mieux les mardis et samedis. Essayez d'identifier ce qui fonctionne ces jours-l√† !
                            </div>
                        </div>
                        
                        <div class="insight-item">
                            <span class="insight-icon">üéØ</span>
                            <div class="insight-text">
                                <strong>Objectif 2026 :</strong> √Ä ce rythme (100%), vous atteindrez 365 routines compl√©t√©es. Vous d√©passerez largement votre ann√©e 2025 !
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Monthly Breakdown -->
                <div class="chart-container">
                    <h3 class="chart-title" style="margin-bottom: 20px;">Comparaison Mensuelle</h3>
                    <div class="chart">
                        <div class="bar-container">
                            <div class="bar" style="height: 100%;"></div>
                            <span class="bar-label">Jan</span>
                        </div>
                        <div class="bar-container">
                            <div class="bar" style="height: 45%; opacity: 0.3;"></div>
                            <span class="bar-label">F√©v</span>
                        </div>
                        <div class="bar-container">
                            <div class="bar" style="height: 38%; opacity: 0.3;"></div>
                            <span class="bar-label">Mar</span>
                        </div>
                        <div class="bar-container">
                            <div class="bar" style="height: 52%; opacity: 0.3;"></div>
                            <span class="bar-label">Avr</span>
                        </div>
                        <div class="bar-container">
                            <div class="bar" style="height: 68%; opacity: 0.3;"></div>
                            <span class="bar-label">Mai</span>
                        </div>
                        <div class="bar-container">
                            <div class="bar" style="height: 85%; opacity: 0.3;"></div>
                            <span class="bar-label">Jun</span>
                        </div>
                    </div>
                    <p style="text-align: center; font-size: 12px; color: var(--text-light); margin-top: 12px;">
                        Comparaison avec 2025 (barres att√©nu√©es)
                    </p>
                </div>
            </div>
        </div>

        <!-- History Screen -->
        <div class="screen" id="historyScreen">
            <div class="header">
                <h1 class="greeting">Historique</h1>
                <p class="date-info">Vos routines pass√©es</p>
            </div>
            
            <div class="content">
                <div class="history-list">
                    <!-- Rempli dynamiquement par JavaScript -->
                </div>
            </div>
        </div>

        <!-- Settings Screen -->
        <div class="screen" id="settingsScreen">
            <div class="header">
                <h1 class="greeting">Param√®tres</h1>
                <p class="date-info">Personnalisez votre exp√©rience</p>
            </div>
            
            <div class="content">
                <!-- Profile Card -->
                <div class="profile-card">
                    <div class="profile-avatar">üë§</div>
                    <div class="profile-name">Utilisateur</div>
                    <div class="profile-email">user@example.com</div>
                    <div class="profile-stats">
                        <div class="profile-stat">
                            <div class="profile-stat-value" id="profileDays">6</div>
                            <div class="profile-stat-label">Jours total</div>
                        </div>
                        <div class="profile-stat">
                            <div class="profile-stat-value" id="profileLevel">Niv. 5</div>
                            <div class="profile-stat-label">Niveau</div>
                        </div>
                        <div class="profile-stat">
                            <div class="profile-stat-value" id="profileBadges">3</div>
                            <div class="profile-stat-label">Badges</div>
                        </div>
                    </div>
                </div>
                
                <!-- Appearance -->
                <div class="settings-section">
                    <div class="settings-title">Apparence</div>
                    <div class="settings-item" onclick="toggleTheme()">
                        <div class="settings-label">
                            <span>üåô</span>
                            <span>Mode sombre</span>
                        </div>
                        <div class="toggle-switch active" id="themeToggle">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Notifications -->
                <div class="settings-section">
                    <div class="settings-title">Notifications</div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>üîî</span>
                            <span>Rappel quotidien</span>
                        </div>
                        <div class="toggle-switch active">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>‚è∞</span>
                            <span>Heure du rappel</span>
                        </div>
                        <div class="settings-value">7:00 AM</div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>üèÜ</span>
                            <span>Notifications de badges</span>
                        </div>
                        <div class="toggle-switch active">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Routine -->
                <div class="settings-section">
                    <div class="settings-title">Routine</div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>üèÉ</span>
                            <span>Dur√©e exercice</span>
                        </div>
                        <div class="settings-value">5 min</div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>üßò</span>
                            <span>Dur√©e m√©ditation</span>
                        </div>
                        <div class="settings-value">5 min</div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>üìù</span>
                            <span>Journal obligatoire</span>
                        </div>
                        <div class="toggle-switch">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Integrations -->
                <div class="settings-section">
                    <div class="settings-title">Int√©grations</div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>üå§Ô∏è</span>
                            <span>M√©t√©o</span>
                        </div>
                        <div class="settings-value">Activ√©</div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>üìÖ</span>
                            <span>Calendrier</span>
                        </div>
                        <div class="settings-value">Connecter</div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>‚ù§Ô∏è</span>
                            <span>Apple Health</span>
                        </div>
                        <div class="settings-value">Connecter</div>
                    </div>
                </div>
                
                <!-- About -->
                <div class="settings-section">
                    <div class="settings-title">√Ä propos</div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>‚ÑπÔ∏è</span>
                            <span>Version</span>
                        </div>
                        <div class="settings-value">1.0.0</div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>üìÑ</span>
                            <span>Politique de confidentialit√©</span>
                        </div>
                        <div class="settings-value">‚Üí</div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>üìß</span>
                            <span>Support</span>
                        </div>
                        <div class="settings-value">‚Üí</div>
                    </div>
                </div>
                
                <!-- Danger Zone -->
                <div class="settings-section">
                    <div class="settings-item" style="border: 1px solid rgba(239, 68, 68, 0.3);">
                        <div class="settings-label" style="color: #EF4444;">
                            <span>üóëÔ∏è</span>
                            <span>R√©initialiser toutes les donn√©es</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <a class="nav-item active" onclick="switchScreen('home')">
                <span class="nav-icon">‚òÄÔ∏è</span>
                <span class="nav-label">Aujourd'hui</span>
            </a>
            <a class="nav-item" onclick="switchScreen('dashboard')">
                <span class="nav-icon">üìä</span>
                <span class="nav-label">Progr√®s</span>
            </a>
            <a class="nav-item" onclick="switchScreen('comparison')">
                <span class="nav-icon">üìà</span>
                <span class="nav-label">Comparaison</span>
            </a>
            <a class="nav-item" onclick="switchScreen('history')">
                <span class="nav-icon">üìã</span>
                <span class="nav-label">Historique</span>
            </a>
            <a class="nav-item" onclick="switchScreen('settings')">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span class="nav-label">Param√®tres</span>
            </a>
        </div>

    <script>
        /* ========================================
    MORNING RITUAL - ADDITIONAL FEATURES
    JavaScript pour: Badges, XP, Niveaux, Th√®me
    ======================================== */

    // ========== USER DATA ==========
    let userData = {
        xp: 60,
        level: 5,
        totalDays: 6,
        currentStreak: 12,
        badges: [
            {id: 'fire', unlocked: true},
            {id: 'warrior', unlocked: true},
            {id: 'star', unlocked: true},
            {id: 'champion', unlocked: false},
            {id: 'diamond', unlocked: false},
            {id: 'master', unlocked: false}
        ],
        history: []
    };

    // ========== BADGE SYSTEM ==========
    const badgesData = [
        {
            id: 'fire',
            name: 'S√©rie de Feu',
            icon: 'üî•',
            description: '7 jours cons√©cutifs',
            condition: (data) => data.currentStreak >= 7
        },
        {
            id: 'warrior',
            name: 'Guerrier',
            icon: 'üí™',
            description: '30 jours total',
            condition: (data) => data.totalDays >= 30
        },
        {
            id: 'star',
            name: '√âtoile du Matin',
            icon: 'üåü',
            description: 'Semaine parfaite',
            condition: (data) => data.currentStreak >= 7
        },
        {
            id: 'champion',
            name: 'Champion',
            icon: 'üèÜ',
            description: '100 jours total',
            condition: (data) => data.totalDays >= 100
        },
        {
            id: 'diamond',
            name: 'Diamant',
            icon: 'üíé',
            description: '30 jours cons√©cutifs',
            condition: (data) => data.currentStreak >= 30
        },
        {
            id: 'master',
            name: 'Ma√Ætre',
            icon: 'üëë',
            description: '365 jours total',
            condition: (data) => data.totalDays >= 365
        }
    ];

    // ========== LEVEL SYSTEM ==========
    const levelNames = {
        1: 'D√©butant',
        2: 'Apprenti',
        3: 'Pratiquant',
        4: 'Pratiquant Assidu',
        5: 'Pratiquant D√©vou√©',
        6: 'Expert D√©butant',
        7: 'Expert',
        8: 'Expert Confirm√©',
        9: 'Ma√Ætre D√©butant',
        10: 'Ma√Ætre',
        11: 'Ma√Ætre √âclair√©',
        12: 'Sage',
        13: 'Grand Sage',
        14: 'L√©gende Vivante',
        15: 'L√©gende √âternelle'
    };

    function getXPForLevel(level) {
        // XP needed to reach next level
        return Math.floor(50 * Math.pow(1.5, level - 1));
    }

    function getLevelFromXP(xp) {
        let level = 1;
        let totalXP = 0;
        
        while (totalXP + getXPForLevel(level) <= xp) {
            totalXP += getXPForLevel(level);
            level++;
        }
        
        return {
            level: level,
            currentLevelXP: xp - totalXP,
            xpForNextLevel: getXPForLevel(level)
        };
    }

    function updateLevelDisplay() {
        const levelInfo = getLevelFromXP(userData.xp);
        const levelNumber = document.getElementById('levelNumber');
        const levelName = document.getElementById('levelName');
        const xpFill = document.getElementById('xpFill');
        const xpText = document.getElementById('xpText');
        
        if (levelNumber) {
            levelNumber.textContent = levelInfo.level;
            levelName.textContent = levelNames[levelInfo.level] || 'L√©gende';
            
            const percentage = (levelInfo.currentLevelXP / levelInfo.xpForNextLevel) * 100;
            xpFill.style.width = percentage + '%';
            xpText.textContent = `${levelInfo.currentLevelXP} / ${levelInfo.xpForNextLevel} XP jusqu'au niveau ${levelInfo.level + 1}`;
        }
    }

    // ========== BADGE FUNCTIONS ==========
    function checkAndUnlockBadges() {
        let newBadges = [];
        
        badgesData.forEach(badge => {
            const userBadge = userData.badges.find(b => b.id === badge.id);
            if (userBadge && !userBadge.unlocked && badge.condition(userData)) {
                userBadge.unlocked = true;
                newBadges.push(badge);
            }
        });
        
        return newBadges;
    }

    function renderBadges() {
        const container = document.querySelector('.badges-container');
        if (!container) return;
        
        container.innerHTML = '';
        
        badgesData.forEach(badge => {
            const userBadge = userData.badges.find(b => b.id === badge.id);
            const isUnlocked = userBadge && userBadge.unlocked;
            
            const badgeCard = document.createElement('div');
            badgeCard.className = `badge-card ${isUnlocked ? '' : 'locked'}`;
            badgeCard.innerHTML = `
                <div class="badge-icon">${badge.icon}</div>
                <div class="badge-name">${badge.name}</div>
                <div class="badge-desc">${badge.description}</div>
            `;
            
            if (isUnlocked) {
                badgeCard.addEventListener('click', () => {
                    alert(`üéâ ${badge.name}\n\n${badge.description}\n\nVous avez d√©bloqu√© ce badge !`);
                });
            }
            
            container.appendChild(badgeCard);
        });
    }

    // ========== XP & ROUTINE COMPLETION ==========
    function completeRoutineWithXP() {
        const sportChecked = document.getElementById('sportCheckbox').classList.contains('checked');
        const meditationChecked = document.getElementById('meditationCheckbox').classList.contains('checked');
        const journalText = document.getElementById('journalText').value.trim();
        
        let xpGained = 0;
        let message = 'üéâ Bravo ! Routine valid√©e pour aujourd\'hui.\n\n';
        
        // Calculate XP
        if (sportChecked) {
            xpGained += 10;
            message += '‚úì Exercice compl√©t√© (+10 XP)\n';
        } else {
            message += '‚óã Exercice non fait\n';
        }
        
        if (meditationChecked) {
            xpGained += 10;
            message += '‚úì M√©ditation compl√©t√©e (+10 XP)\n';
        } else {
            message += '‚óã M√©ditation non faite\n';
        }
        
        if (journalText) {
            xpGained += 5;
            message += '‚úì Journal √©crit (+5 XP)\n';
        }
        
        // Update user data
        const previousLevel = getLevelFromXP(userData.xp).level;
        userData.xp += xpGained;
        userData.totalDays++;
        userData.currentStreak++;
        const newLevel = getLevelFromXP(userData.xp).level;
        
        message += `\nüí´ ${xpGained} XP gagn√©s !\n`;
        
        // Check for level up
        if (newLevel > previousLevel) {
            message += `\nüéä NIVEAU SUP√âRIEUR !\nVous √™tes maintenant niveau ${newLevel} : ${levelNames[newLevel]}`;
        }
        
        // Check for new badges
        const newBadges = checkAndUnlockBadges();
        if (newBadges.length > 0) {
            message += '\n\nüèÜ NOUVEAU BADGE !\n';
            newBadges.forEach(badge => {
                message += `${badge.icon} ${badge.name}\n`;
            });
        }
        
        // Add to history
        userData.history.unshift({
            date: new Date(),
            sport: sportChecked,
            meditation: meditationChecked,
            journal: !!journalText,
            xp: xpGained
        });
        
        alert(message);
        
        // Update displays
        updateLevelDisplay();
        renderBadges();
        saveUserData();
        
        // Visual feedback
        const btn = event.currentTarget;
        btn.textContent = '‚úì Valid√© !';
        btn.style.background = '#10B981';
        setTimeout(() => {
            btn.textContent = '‚úì Routine termin√©e';
            btn.style.background = '';
        }, 2000);
    }

    // ========== THEME TOGGLE ==========
    function toggleTheme() {
        const root = document.documentElement;
        const themeToggle = document.getElementById('themeToggle');
        const currentTheme = root.getAttribute('data-theme');
        
        if (currentTheme === 'light') {
            root.setAttribute('data-theme', 'dark');
            if (themeToggle) themeToggle.classList.add('active');
            localStorage.setItem('theme', 'dark');
        } else {
            root.setAttribute('data-theme', 'light');
            if (themeToggle) themeToggle.classList.remove('active');
            localStorage.setItem('theme', 'light');
        }
    }

    function loadTheme() {
        const savedTheme = localStorage.getItem('theme') || 'dark';
        const root = document.documentElement;
        const themeToggle = document.getElementById('themeToggle');
        
        root.setAttribute('data-theme', savedTheme);
        if (themeToggle) {
            if (savedTheme === 'dark') {
                themeToggle.classList.add('active');
            } else {
                themeToggle.classList.remove('active');
            }
        }
    }

    // ========== HISTORY RENDERING ==========
    function renderHistory() {
        const historyList = document.querySelector('.history-list');
        if (!historyList) return;
        
        historyList.innerHTML = '';
        
        // Sample history data (in production, this would come from userData.history)
        const sampleHistory = [
            {date: new Date(2026, 0, 6), sport: true, meditation: true, journal: true},
            {date: new Date(2026, 0, 5), sport: true, meditation: true, journal: false},
            {date: new Date(2026, 0, 4), sport: true, meditation: true, journal: true},
            {date: new Date(2026, 0, 3), sport: true, meditation: false, journal: false},
            {date: new Date(2026, 0, 2), sport: true, meditation: true, journal: true},
            {date: new Date(2026, 0, 1), sport: true, meditation: true, journal: false}
        ];
        
        const months = ['Jan', 'F√©v', 'Mar', 'Avr', 'Mai', 'Jun', 'Jul', 'Ao√ª', 'Sep', 'Oct', 'Nov', 'D√©c'];
        
        sampleHistory.forEach(item => {
            const day = item.date.getDate();
            const month = months[item.date.getMonth()];
            const isComplete = item.sport && item.meditation;
            
            const historyItem = document.createElement('div');
            historyItem.className = 'history-item';
            
            let activities = '';
            activities += item.sport ? '‚úì Exercice' : '‚óã Exercice';
            activities += ' ‚Ä¢ ';
            activities += item.meditation ? '‚úì M√©ditation' : '‚óã M√©ditation';
            if (item.journal) {
                activities += ' ‚Ä¢ üìù Journal';
            }
            
            historyItem.innerHTML = `
                <div class="history-date">
                    <div class="history-day">${day}</div>
                    <div class="history-month">${month}</div>
                </div>
                <div class="history-details">
                    <div class="history-status">${isComplete ? 'Routine compl√©t√©e' : 'Routine partielle'}</div>
                    <div class="history-activities">${activities}</div>
                </div>
                <span class="history-icon">${isComplete ? '‚úÖ' : '‚ö†Ô∏è'}</span>
            `;
            
            historyList.appendChild(historyItem);
        });
    }

    // ========== CHARACTER COUNT FOR JOURNAL ==========
    function updateCharCount() {
        const textarea = document.getElementById('journalText');
        const charCount = document.getElementById('charCount');
        if (textarea && charCount) {
            const count = textarea.value.length;
            charCount.textContent = `${count} / 500`;
        }
    }

    // ========== DATA PERSISTENCE ==========
    function saveUserData() {
        localStorage.setItem('morningRitualUserData', JSON.stringify(userData));
    }

    function loadUserData() {
        const saved = localStorage.getItem('morningRitualUserData');
        if (saved) {
            userData = JSON.parse(saved);
        }
    }

    // ========== ENHANCED SCREEN SWITCHING ==========
    function switchScreenEnhanced(screen) {
        // Hide all screens
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        
        // Show selected screen
        const screenMap = {
            'home': 'homeScreen',
            'dashboard': 'dashboardScreen',
            'comparison': 'comparisonScreen',
            'history': 'historyScreen',
            'settings': 'settingsScreen'
        };
        
        const screenId = screenMap[screen];
        if (screenId) {
            document.getElementById(screenId).classList.add('active');
        }
        
        // Render content based on screen
        if (screen === 'dashboard') {
            updateLevelDisplay();
            renderBadges();
        } else if (screen === 'history') {
            renderHistory();
        } else if (screen === 'settings') {
            loadTheme();
        }
        
        // Update nav items
        document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.remove('active');
        });
        event.currentTarget.classList.add('active');
    }

    // ========== INITIALIZATION ==========
    function initializeNewFeatures() {
        loadUserData();
        loadTheme();
        updateLevelDisplay();
        renderBadges();
        
        // Setup journal character counter
        const journalText = document.getElementById('journalText');
        if (journalText) {
            journalText.addEventListener('input', updateCharCount);
        }
        
        // Replace original completeRoutine with XP version
        window.completeRoutine = completeRoutineWithXP;
        
        // Replace original switchScreen with enhanced version
        window.switchScreen = switchScreenEnhanced;
        
        console.log('‚úÖ Morning Ritual - Nouvelles fonctionnalit√©s charg√©es !');
    }

    // Auto-initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeNewFeatures);
    } else {
        initializeNewFeatures();
    }
    </script>
</body>
</html>